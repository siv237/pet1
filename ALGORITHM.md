# Алгоритм работы Smart Todo List

## 1. Архитектура приложения

### 1.1 Компоненты системы
- Frontend (React.js)
- Backend API (FastAPI)
- База данных (PostgreSQL)
- Сервис уведомлений
- Интеграция с Google Calendar

### 1.2 Структура базы данных
```
Users
- id: UUID (PK)
- email: String
- password_hash: String
- created_at: Timestamp
- settings: JSON

Tasks
- id: UUID (PK)
- user_id: UUID (FK)
- title: String
- description: Text
- priority: Enum(high, medium, low)
- due_date: Timestamp
- status: Enum(todo, in_progress, done)
- created_at: Timestamp
- updated_at: Timestamp

Categories
- id: UUID (PK)
- user_id: UUID (FK)
- name: String
- color: String

TaskCategories
- task_id: UUID (FK)
- category_id: UUID (FK)

Tags
- id: UUID (PK)
- name: String
- user_id: UUID (FK)

TaskTags
- task_id: UUID (FK)
- tag_id: UUID (FK)

Reminders
- id: UUID (PK)
- task_id: UUID (FK)
- reminder_time: Timestamp
- type: Enum(email, push, both)
- status: Enum(pending, sent)
```

## 2. Основные процессы

### 2.1 Аутентификация
1. Регистрация пользователя
   - Валидация email
   - Хеширование пароля
   - Создание записи в БД
   - Отправка приветственного email

2. Авторизация
   - Проверка учетных данных
   - Генерация JWT токена
   - Установка cookies

### 2.2 Управление задачами
1. Создание задачи
   - Валидация входных данных
   - Сохранение в БД
   - Создание связей с категориями/тегами
   - Установка напоминаний
   - Синхронизация с календарем

2. Обновление задачи
   - Проверка прав доступа
   - Валидация изменений
   - Обновление связанных сущностей
   - Пересчет напоминаний

3. Удаление задачи
   - Проверка прав доступа
   - Удаление связанных данных
   - Удаление из календаря

### 2.3 Система напоминаний
1. Создание напоминания
   - Валидация времени
   - Запись в очередь уведомлений

2. Процесс отправки уведомлений
   - Проверка очереди уведомлений
   - Определение типа уведомления
   - Отправка уведомления
   - Обновление статуса

### 2.4 Интеграция с календарем
1. Подключение к Google Calendar
   - OAuth2 авторизация
   - Получение токена доступа
   - Сохранение токена

2. Синхронизация задач
   - Создание события в календаре
   - Обновление события при изменении задачи
   - Удаление события при удалении задачи

## 3. Алгоритмы приоритизации

### 3.1 Расчет приоритета задачи
Приоритет задачи рассчитывается на основе:
- Установленного пользователем уровня важности
- Срока выполнения
- Зависимостей от других задач
- Истории выполнения подобных задач

### 3.2 Сортировка задач
Алгоритм сортировки учитывает:
1. Приоритет задачи (вес: 40%)
2. Срочность (вес: 30%)
3. Сложность выполнения (вес: 20%)
4. Зависимости (вес: 10%)

## 4. Оптимизация производительности

### 4.1 Кэширование
- Кэширование часто запрашиваемых задач
- Кэширование настроек пользователя
- Кэширование результатов поиска

### 4.2 Индексация
- Индекс по полю due_date для быстрого поиска предстоящих задач
- Составной индекс (user_id, status) для фильтрации
- Полнотекстовый поиск по title и description

## 5. Безопасность

### 5.1 Защита данных
- Шифрование чувствительных данных
- Валидация входных данных
- Защита от SQL-инъекций
- Rate limiting для API endpoints

### 5.2 Аудит
- Логирование важных действий
- Отслеживание подозрительной активности
- История изменений задач
